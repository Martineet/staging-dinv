(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2328:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d}),t(8256),t(9515),t(5866);var a=t(3191),r=t(8716),n=t(7922),i=t.n(n),l=t(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let d=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8256)),"C:\\Users\\marti.castan\\Documents\\altres\\D.Inversions\\PgWeb\\prod-dinv\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9515)),"C:\\Users\\marti.castan\\Documents\\altres\\D.Inversions\\PgWeb\\prod-dinv\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\marti.castan\\Documents\\altres\\D.Inversions\\PgWeb\\prod-dinv\\src\\app\\dashboard\\page.tsx"],u="/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7979:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},6970:(e,s,t)=>{Promise.resolve().then(t.bind(t,9509))},2304:(e,s,t)=>{Promise.resolve().then(t.bind(t,5684))},9509:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(326),r=t(7577),n=t(5047);function i({displayName:e}){return a.jsx("div",{className:"header",children:(0,a.jsxs)("h1",{className:"welcome",children:["Welcome, ",a.jsx("span",{children:e}),"!"]})})}var l=t(5295),o=t(5077);function d({rows:e,loading:s,error:t}){return a.jsx("section",{className:"investments-shell",children:(0,a.jsxs)("div",{className:"investments-table",children:[a.jsx("h2",{children:"Your Investments"}),s?a.jsx("div",{className:"loading",children:"Loading your investments..."}):t?a.jsx("p",{className:"error centered-text",children:t}):e.length?a.jsx("div",{className:"table-scroll",children:(0,a.jsxs)("table",{children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"BTC Amount"}),a.jsx("th",{children:`€ Invested`}),a.jsx("th",{children:"Purchase Price"}),a.jsx("th",{children:"Current Value"}),a.jsx("th",{children:"Profit/Loss"}),a.jsx("th",{children:"Notes"})]})}),a.jsx("tbody",{children:e.map((e,s)=>{let t=e.profitLoss>=0?"+":"";return(0,a.jsxs)("tr",{children:[a.jsx("td",{children:e.date}),a.jsx("td",{children:e.type}),a.jsx("td",{children:`${(0,o.jl)(e.btcAmount)} BTC`}),a.jsx("td",{children:`${(0,o.fr)(e.eurAmount)} €`}),a.jsx("td",{children:`${(0,o.fr)(e.purchasePrice)} €`}),a.jsx("td",{children:`${(0,o.fr)(e.currentValue)} €`}),a.jsx("td",{className:e.profitLoss>=0?"positive":"negative",children:`${t}${(0,o.fr)(e.profitLoss)} €`}),a.jsx("td",{children:e.notes})]},`${e.date}-${s}`)})})]})}):a.jsx("p",{className:"muted centered-text",children:"No investments yet."})]})})}var c=t(9155);function u({totals:e}){let s=s=>e&&null!=s?`${(0,o.fr)(s)} €`:"-- €",t=e?e.totalProfitLoss:0,r=t>=0?"+":"",n=e?`${(0,o.jl)(e.totalBTC)} BTC`:"-- BTC",i=e?.onboardedDate??"--";return(0,a.jsxs)("div",{className:"stats-grid",children:[(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Btc hodled"}),a.jsx("div",{className:"stat-value",children:n})]}),(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Current Value"}),a.jsx("div",{className:"stat-value",children:s(e?.totalCurrentValue)})]}),(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Total Invested"}),a.jsx("div",{className:"stat-value",children:s(e?.totalInvested)})]}),(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Average Purchase Price"}),a.jsx("div",{className:"stat-value",children:s(e?.averagePurchasePrice)})]}),(0,a.jsxs)("div",{className:"stat-card highlight",children:[a.jsx("div",{className:"stat-label",children:"Final Value"}),a.jsx("div",{className:"stat-value highlight-value",children:s(e?.totalFinalValue)})]}),(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Result"}),a.jsx("div",{className:`stat-value ${t>=0?"positive":"negative"}`,children:e?`${r}${(0,o.fr)(t)} €`:"-- €"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Total Taxes"}),a.jsx("div",{className:"stat-value",children:s(e?.totalTaxes)})]}),(0,a.jsxs)("div",{className:"stat-card",children:[a.jsx("div",{className:"stat-label",children:"Onboarded"}),a.jsx("div",{className:"stat-value",children:i})]})]})}var m=t(4131),h=t(2451),p=t(958),v=t(3566);function x(e){if(null==e)return 0;let s="string"==typeof e?Number(e):e;return Number.isFinite(s)?s:0}function g(){(0,n.useRouter)();let{session:e,user:s,loading:t}=(0,m.a)(),{price:o}=(0,h.k)(),{member:g,investments:j,loading:b,error:f,refresh:w}=function(e){let[s,t]=(0,r.useState)(null),[a,n]=(0,r.useState)([]),[i,l]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null);return{member:s,investments:a,loading:i,error:o,refresh:(0,r.useCallback)(async()=>{if(!e?.email){t(null),n([]),l(!1),d(null);return}l(!0);try{let s=await (0,p.jS)(e.email);if(!s){d("Could not find your account. Contact the administrator."),t(null),n([]),l(!1);return}let a=await (0,p.TI)(s.member_id);t(s),n(a),d(null)}catch(e){d(e instanceof Error?e.message:"Error loading investments."),t(null),n([])}finally{l(!1)}},[e])}}(s),N=(0,r.useMemo)(()=>j.length&&o?function(e,s){let t=0,a=0,r=0,n=0,i=null;e.forEach(e=>{let l=x(e.btc_amount),o=x(e.eur_amount),d=l*s*v.HC,c=0,u=d;d>o&&(c=(d-o)*v.n,u=d-c),t+=o,a+=l,r+=u,n+=c,(!i||e.date_swap<i)&&(i=e.date_swap)});let l=a*s*v.HC,o=a>0?t/a:0,d=r-t;return{totalInvested:t,totalBTC:a,averagePurchasePrice:o,totalCurrentValue:l,totalFinalValue:r,totalTaxes:n,totalProfitLoss:d,onboardedDate:i}}(j,o):null,[j,o]),P=(0,r.useMemo)(()=>j.length&&o?j.map(e=>{let s=x(e.btc_amount),t=x(e.eur_amount),a=x(e.purchase_price),r=s*o*v.HC;return{date:e.date_swap,type:e.type??"-",notes:e.notes??"-",btcAmount:s,eurAmount:t,purchasePrice:a,currentValue:r,profitLoss:r-t}}):[],[j,o]);if(t)return a.jsx("div",{className:"container",children:a.jsx("div",{className:"loading",children:"Loading..."})});let C=g?.display_name||s?.email||"Investor";return(0,a.jsxs)("div",{className:"container",children:[a.jsx(i,{displayName:C}),a.jsx(u,{totals:N}),a.jsx(d,{rows:P,loading:b,error:f}),a.jsx(c.x,{}),a.jsx(l.$,{})]})}},5295:(e,s,t)=>{"use strict";t.d(s,{$:()=>r});var a=t(326);function r(){return(0,a.jsxs)("div",{className:"footer",children:[(0,a.jsxs)("p",{children:["\xa9 2026 ",a.jsx("strong",{children:"D.Inversions"})," - All rights reserved"]}),(0,a.jsxs)("p",{className:"footer-note",children:["Bitcoin Portfolio Tracker | Powered by"," ",a.jsx("a",{href:"https://www.coingecko.com/es/monedas/bitcoin",target:"_blank",rel:"noreferrer",children:"CoinGecko API"})]})]})}},5684:(e,s,t)=>{"use strict";t.d(s,{LandingHeader:()=>u});var a=t(326),r=t(7577),n=t(5047),i=t(4131);function l({isOpen:e,onClose:s}){let{changePassword:t}=(0,i.a)(),[n,l]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(""),[p,v]=(0,r.useState)(""),[x,g]=(0,r.useState)(!1),j=()=>{l(""),d(""),u(""),h(""),v(""),g(!1)},b=()=>{j(),s()},f=async()=>{if(h(""),v(""),o.length<6){h("Password must be at least 6 characters.");return}if(o!==c){h("Passwords do not match.");return}if(!n){h("Please enter your current password.");return}g(!0);try{await t(n,o),v("Password updated. Logging out...")}catch(e){h(e instanceof Error?e.message:"Unable to update password."),g(!1)}};return e?a.jsx("div",{className:"modal-overlay open",onClick:e=>e.currentTarget===e.target&&b(),children:(0,a.jsxs)("div",{className:"modal",children:[a.jsx("h3",{children:"Change Password"}),(0,a.jsxs)("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"currentPassword",children:"Current password"}),a.jsx("input",{type:"password",id:"currentPassword",value:n,onChange:e=>l(e.target.value),placeholder:"Enter current password",autoComplete:"current-password"})]}),(0,a.jsxs)("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"newPassword",children:"New password"}),a.jsx("input",{type:"password",id:"newPassword",value:o,onChange:e=>d(e.target.value),placeholder:"At least 6 characters",autoComplete:"new-password"})]}),(0,a.jsxs)("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"confirmPassword",children:"Confirm new password"}),a.jsx("input",{type:"password",id:"confirmPassword",value:c,onChange:e=>u(e.target.value),placeholder:"Repeat password",autoComplete:"new-password"})]}),m?a.jsx("div",{className:"error",children:m}):null,p?a.jsx("div",{className:"info-msg",children:p}):null,(0,a.jsxs)("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",className:"btn-secondary",onClick:b,disabled:x,children:"Cancel"}),a.jsx("button",{type:"button",onClick:f,disabled:x,children:x?"Saving...":"Save"})]})]})}):null}function o({onChangePassword:e,onLogout:s}){let[t,n]=(0,r.useState)(!1),i=(0,r.useRef)(null);return(0,a.jsxs)("div",{className:"settings-wrapper",ref:i,children:[a.jsx("button",{type:"button",className:"settings-btn",title:"Settings","aria-label":"Settings",onClick:()=>n(e=>!e),children:"⚙️"}),(0,a.jsxs)("div",{className:`settings-dropdown ${t?"open":""}`,children:[a.jsx("button",{type:"button",className:"settings-item",onClick:()=>{n(!1),e()},children:`\uD83D\uDD11 Change Password`}),a.jsx("div",{className:"settings-divider"}),a.jsx("button",{type:"button",className:"settings-item danger",onClick:()=>{n(!1),s()},children:`\uD83D\uDEAA Logout`})]})]})}var d=t(5077),c=t(2451);function u(){let e=(0,n.useRouter)(),s=(0,n.usePathname)(),{session:t,loading:u,signOut:m}=(0,i.a)(),{price:h}=(0,c.k)(),[p,v]=(0,r.useState)(!1),x=h?`${(0,d.fr)(h)} €`:`-- €`;return(0,a.jsxs)("header",{className:"landing-top-nav",role:"banner",children:[(0,a.jsxs)("div",{className:"landing-top-nav-left",children:[a.jsx("div",{className:"nav-brand-logo","aria-hidden":"true",children:a.jsx("img",{src:"/log1.png",alt:""})}),a.jsx("a",{href:"https://www.dinversions.org/",className:"header-title nav-title-link",children:"D.Inversions"}),a.jsx("div",{id:"headerBtcPrice",className:"header-btc-price",children:x})]}),a.jsx("div",{className:"landing-top-nav-middle",children:a.jsx("p",{className:"nav-quote",children:"Bitcoin is building the next global monetary system"})}),a.jsx("div",{className:"landing-top-nav-right",children:!u&&t?(0,a.jsxs)(a.Fragment,{children:[a.jsx(o,{onChangePassword:()=>v(!0),onLogout:()=>m()}),a.jsx(l,{isOpen:p,onClose:()=>v(!1)})]}):a.jsx("button",{type:"button",className:"members-zone-btn",onClick:()=>{if("/"!==s){sessionStorage.setItem("open_members_zone","1"),e.push("/");return}window.dispatchEvent(new CustomEvent("open-members-zone"))},children:"Members Zone"})})]})}},9155:(e,s,t)=>{"use strict";t.d(s,{x:()=>r});var a=t(326);function r(){return(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"dinversions-logo",children:a.jsx("img",{src:"/log1.png",alt:"D.Inversions Logo"})}),a.jsx("div",{className:"btc-logo",children:a.jsx("img",{src:"https://cryptologos.cc/logos/bitcoin-btc-logo.svg",alt:"Bitcoin Logo"})})]})}},4131:(e,s,t)=>{"use strict";t.d(s,{a:()=>n});var a=t(7577),r=t(4800);function n(){let[e,s]=(0,a.useState)(null),[t,n]=(0,a.useState)(!0),i=(0,a.useCallback)(async(e,s)=>r.O.auth.signInWithPassword({email:e,password:s}),[]),l=(0,a.useCallback)(async()=>r.O.auth.signOut(),[]),o=(0,a.useCallback)(async(e,s)=>{let{data:t}=await r.O.auth.getUser(),a=t.user;if(!a?.email)throw Error("No active session. Please log in again.");let{error:n}=await r.O.auth.signInWithPassword({email:a.email,password:e});if(n)throw n;let{error:i}=await r.O.auth.updateUser({password:s});if(i)throw i;sessionStorage.setItem("pw_changed","1"),await r.O.auth.signOut()},[]);return{session:e,user:e?.user??null,loading:t,signIn:i,signOut:l,changePassword:o}}},2451:(e,s,t)=>{"use strict";t.d(s,{k:()=>n});var a=t(7577);async function r(){let e=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=eur");if(!e.ok)throw Error("Failed to fetch BTC price.");let s=await e.json(),t=s?.bitcoin?.eur;if(!t||"number"!=typeof t)throw Error("BTC price data unavailable.");return t}function n(e=6e4){let[s,t]=(0,a.useState)(0),[n,i]=(0,a.useState)(!0),[l,o]=(0,a.useState)(null);return{price:s,loading:n,error:l,refresh:(0,a.useCallback)(async()=>{try{let e=await r();t(e),o(null)}catch(e){o(e instanceof Error?e.message:"Failed to load BTC price.")}finally{i(!1)}},[])}}},3566:(e,s,t)=>{"use strict";t.d(s,{HC:()=>n,JA:()=>r,n:()=>a});let a=.21,r=20,n=.99},5077:(e,s,t)=>{"use strict";t.d(s,{fr:()=>i,jl:()=>l,lb:()=>n});let a=new Intl.NumberFormat("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),r=new Intl.NumberFormat("de-DE",{maximumFractionDigits:0});function n(e){return a.format(e)}function i(e){return r.format(e)}function l(e){return e.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:5})}},958:(e,s,t)=>{"use strict";t.d(s,{TI:()=>n,jS:()=>r});var a=t(4800);async function r(e){let{data:s,error:t}=await a.O.from("members").select("member_id, display_name, email").eq("email",e).single();if(t)throw t;return s||null}async function n(e){let{data:s,error:t}=await a.O.from("investments").select("*").eq("member_id",e).order("date_swap",{ascending:!0});if(t)throw t;return s??[]}},4800:(e,s,t)=>{"use strict";t.d(s,{O:()=>i});var a=t(5157);let r=process.env.NEXT_PUBLIC_SUPABASE_URL,n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!r||!n)throw Error("Missing Supabase environment variables.");let i=(0,a.eI)(r,n)},8256:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\Users\marti.castan\Documents\altres\D.Inversions\PgWeb\prod-dinv\src\app\dashboard\page.tsx#default`)},9515:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i,metadata:()=>n});var a=t(9510);t(5023);let r=(0,t(8570).createProxy)(String.raw`C:\Users\marti.castan\Documents\altres\D.Inversions\PgWeb\prod-dinv\src\components\LandingHeader.tsx#LandingHeader`),n={title:"D.Inversions - Bitcoin Portfolio",description:"Track your Bitcoin investments and performance."};function i({children:e}){return a.jsx("html",{lang:"en",children:(0,a.jsxs)("body",{children:[a.jsx(r,{}),e]})})}},5023:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,149],()=>t(2328));module.exports=a})();