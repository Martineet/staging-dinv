(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2328:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),t(8256),t(2029),t(5866);var r=t(3191),a=t(8716),n=t(7922),i=t.n(n),l=t(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8256)),"C:\\Users\\marti.castan\\Documents\\altres\\D.Inversions\\PgWeb\\prod-dinv\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2029)),"C:\\Users\\marti.castan\\Documents\\altres\\D.Inversions\\PgWeb\\prod-dinv\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\marti.castan\\Documents\\altres\\D.Inversions\\PgWeb\\prod-dinv\\src\\app\\dashboard\\page.tsx"],u="/dashboard/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7979:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},6970:(e,s,t)=>{Promise.resolve().then(t.bind(t,7127))},3308:()=>{},7127:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(326),a=t(7577),n=t(5047),i=t(4131);function l({isOpen:e,onClose:s}){let{changePassword:t}=(0,i.a)(),[n,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[p,v]=(0,a.useState)(""),[x,g]=(0,a.useState)(!1),j=()=>{l(""),c(""),u(""),m(""),v(""),g(!1)},f=()=>{j(),s()},b=async()=>{if(m(""),v(""),o.length<6){m("Password must be at least 6 characters.");return}if(o!==d){m("Passwords do not match.");return}if(!n){m("Please enter your current password.");return}g(!0);try{await t(n,o),v("Password updated. Logging out...")}catch(e){m(e instanceof Error?e.message:"Unable to update password."),g(!1)}};return e?r.jsx("div",{className:"modal-overlay open",onClick:e=>e.currentTarget===e.target&&f(),children:(0,r.jsxs)("div",{className:"modal",children:[r.jsx("h3",{children:"Change Password"}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"currentPassword",children:"Current password"}),r.jsx("input",{type:"password",id:"currentPassword",value:n,onChange:e=>l(e.target.value),placeholder:"Enter current password",autoComplete:"current-password"})]}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"newPassword",children:"New password"}),r.jsx("input",{type:"password",id:"newPassword",value:o,onChange:e=>c(e.target.value),placeholder:"At least 6 characters",autoComplete:"new-password"})]}),(0,r.jsxs)("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"confirmPassword",children:"Confirm new password"}),r.jsx("input",{type:"password",id:"confirmPassword",value:d,onChange:e=>u(e.target.value),placeholder:"Repeat password",autoComplete:"new-password"})]}),h?r.jsx("div",{className:"error",children:h}):null,p?r.jsx("div",{className:"info-msg",children:p}):null,(0,r.jsxs)("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:f,disabled:x,children:"Cancel"}),r.jsx("button",{type:"button",onClick:b,disabled:x,children:x?"Saving...":"Save"})]})]})}):null}function o({onChangePassword:e,onLogout:s}){let[t,n]=(0,a.useState)(!1),i=(0,a.useRef)(null);return(0,r.jsxs)("div",{className:"settings-wrapper",ref:i,children:[r.jsx("button",{type:"button",className:"settings-btn",title:"Settings","aria-label":"Settings",onClick:()=>n(e=>!e),children:"⚙️"}),(0,r.jsxs)("div",{className:`settings-dropdown ${t?"open":""}`,children:[r.jsx("button",{type:"button",className:"settings-item",onClick:()=>{n(!1),e()},children:"\uD83D\uDD11 Change Password"}),r.jsx("div",{className:"settings-divider"}),r.jsx("button",{type:"button",className:"settings-item danger",onClick:()=>{n(!1),s()},children:"\uD83D\uDEAA Logout"})]})]})}function c({displayName:e,onChangePassword:s,onLogout:t}){return(0,r.jsxs)("div",{className:"header",children:[(0,r.jsxs)("h1",{className:"welcome",children:["Welcome, ",r.jsx("span",{children:e}),"!"]}),r.jsx(o,{onChangePassword:s,onLogout:t})]})}var d=t(5295),u=t(5077);function h({rows:e,loading:s,error:t}){return s?(0,r.jsxs)("div",{className:"investments-table",children:[r.jsx("h2",{children:"Your Investments"}),r.jsx("div",{className:"loading",children:"Loading your investments..."})]}):t?(0,r.jsxs)("div",{className:"investments-table",children:[r.jsx("h2",{children:"Your Investments"}),r.jsx("p",{className:"error centered-text",children:t})]}):e.length?(0,r.jsxs)("div",{className:"investments-table",children:[r.jsx("h2",{children:"Your Investments"}),r.jsx("div",{className:"table-scroll",children:(0,r.jsxs)("table",{children:[r.jsx("thead",{children:(0,r.jsxs)("tr",{children:[r.jsx("th",{children:"Date"}),r.jsx("th",{children:"BTC Amount"}),r.jsx("th",{children:"€ Invested"}),r.jsx("th",{children:"Purchase Price"}),r.jsx("th",{children:"Current Value"}),r.jsx("th",{children:"Profit/Loss"})]})}),r.jsx("tbody",{children:e.map((e,s)=>{let t=e.profitLoss>=0?"+":"";return(0,r.jsxs)("tr",{children:[r.jsx("td",{children:e.date}),r.jsx("td",{children:`${(0,u.jl)(e.btcAmount)} BTC`}),r.jsx("td",{children:`${(0,u.fr)(e.eurAmount)} €`}),r.jsx("td",{children:`${(0,u.fr)(e.purchasePrice)} €`}),r.jsx("td",{children:`${(0,u.fr)(e.currentValue)} €`}),r.jsx("td",{className:e.profitLoss>=0?"positive":"negative",children:`${t}${(0,u.fr)(e.profitLoss)} €`})]},`${e.date}-${s}`)})})]})})]}):(0,r.jsxs)("div",{className:"investments-table",children:[r.jsx("h2",{children:"Your Investments"}),r.jsx("p",{className:"muted centered-text",children:"No investments yet."})]})}var m=t(9155);function p({totals:e}){let s=s=>e&&null!=s?`${(0,u.fr)(s)} €`:"-- €",t=e?e.totalProfitLoss:0,a=t>=0?"+":"",n=e?`${(0,u.jl)(e.totalBTC)} BTC`:"-- BTC";return(0,r.jsxs)("div",{className:"stats-grid",children:[(0,r.jsxs)("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-label",children:"Btc hodled"}),r.jsx("div",{className:"stat-value",children:n})]}),(0,r.jsxs)("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-label",children:"Current Value"}),r.jsx("div",{className:"stat-value",children:s(e?.totalCurrentValue)})]}),(0,r.jsxs)("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-label",children:"Total Invested"}),r.jsx("div",{className:"stat-value",children:s(e?.totalInvested)})]}),(0,r.jsxs)("div",{className:"stat-card highlight",children:[r.jsx("div",{className:"stat-label",children:"Final Value"}),r.jsx("div",{className:"stat-value highlight-value",children:s(e?.totalFinalValue)})]}),(0,r.jsxs)("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-label",children:"Result"}),r.jsx("div",{className:`stat-value ${t>=0?"positive":"negative"}`,children:e?`${a}${(0,u.fr)(t)} €`:"-- €"})]}),(0,r.jsxs)("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-label",children:"Total Taxes"}),r.jsx("div",{className:"stat-value",children:s(e?.totalTaxes)})]})]})}var v=t(2451),x=t(958),g=t(3566);function j(e){if(null==e)return 0;let s="string"==typeof e?Number(e):e;return Number.isFinite(s)?s:0}function f(){(0,n.useRouter)();let{session:e,user:s,loading:t,signOut:o}=(0,i.a)(),{price:u}=(0,v.k)(),{client:f,investments:b,loading:w,error:N,refresh:P}=function(e){let[s,t]=(0,a.useState)(null),[r,n]=(0,a.useState)([]),[i,l]=(0,a.useState)(!0),[o,c]=(0,a.useState)(null);return{client:s,investments:r,loading:i,error:o,refresh:(0,a.useCallback)(async()=>{if(!e?.email){t(null),n([]),l(!1),c(null);return}l(!0);try{let s=await (0,x.Zt)(e.email);if(!s){c("Could not find your account. Contact the administrator."),t(null),n([]),l(!1);return}let r=await (0,x.AW)(s.client_id);t(s),n(r),c(null)}catch(e){c(e instanceof Error?e.message:"Error loading investments."),t(null),n([])}finally{l(!1)}},[e])}}(s),[C,y]=(0,a.useState)(!1),_=(0,a.useMemo)(()=>b.length&&u?function(e,s){let t=0,r=0,a=0,n=0;e.forEach(e=>{let i=j(e.btc_amount),l=j(e.eur_amount),o=i*s*g.HC,c=0,d=o;o>l&&(c=(o-l)*g.n,d=o-c),t+=l,r+=i,a+=d,n+=c});let i=r*s*g.HC,l=a-t;return{totalInvested:t,totalBTC:r,totalCurrentValue:i,totalFinalValue:a,totalTaxes:n,totalProfitLoss:l}}(b,u):null,[b,u]),S=(0,a.useMemo)(()=>b.length&&u?b.map(e=>{let s=j(e.btc_amount),t=j(e.eur_amount),r=j(e.purchase_price),a=s*u*g.HC;return{date:e.date_swap,btcAmount:s,eurAmount:t,purchasePrice:r,currentValue:a,profitLoss:a-t}}):[],[b,u]);if(t)return r.jsx("div",{className:"container",children:r.jsx("div",{className:"loading",children:"Loading..."})});let D=f?.display_name||s?.email||"Investor";return(0,r.jsxs)("div",{className:"container",children:[r.jsx(c,{displayName:D,onChangePassword:()=>y(!0),onLogout:()=>o()}),r.jsx(p,{totals:_}),r.jsx(h,{rows:S,loading:w,error:N}),r.jsx(l,{isOpen:C,onClose:()=>y(!1)}),r.jsx(m.x,{}),r.jsx(d.$,{})]})}},5295:(e,s,t)=>{"use strict";t.d(s,{$:()=>a});var r=t(326);function a(){return(0,r.jsxs)("div",{className:"footer",children:[(0,r.jsxs)("p",{children:["\xa9 2026 ",r.jsx("strong",{children:"D.Inversions"})," - All rights reserved"]}),(0,r.jsxs)("p",{className:"footer-note",children:["Bitcoin Portfolio Tracker | Powered by"," ",r.jsx("a",{href:"https://www.coingecko.com",target:"_blank",rel:"noreferrer",children:"CoinGecko API"})]})]})}},9155:(e,s,t)=>{"use strict";t.d(s,{x:()=>a});var r=t(326);function a(){return(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"dinversions-logo",children:r.jsx("img",{src:"/log1.png",alt:"D.Inversions Logo"})}),r.jsx("div",{className:"btc-logo",children:r.jsx("img",{src:"https://cryptologos.cc/logos/bitcoin-btc-logo.svg",alt:"Bitcoin Logo"})})]})}},4131:(e,s,t)=>{"use strict";t.d(s,{a:()=>n});var r=t(7577),a=t(4800);function n(){let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(!0),i=(0,r.useCallback)(async(e,s)=>a.O.auth.signInWithPassword({email:e,password:s}),[]),l=(0,r.useCallback)(async()=>a.O.auth.signOut(),[]),o=(0,r.useCallback)(async(e,s)=>{let{data:t}=await a.O.auth.getUser(),r=t.user;if(!r?.email)throw Error("No active session. Please log in again.");let{error:n}=await a.O.auth.signInWithPassword({email:r.email,password:e});if(n)throw n;let{error:i}=await a.O.auth.updateUser({password:s});if(i)throw i;sessionStorage.setItem("pw_changed","1"),await a.O.auth.signOut()},[]);return{session:e,user:e?.user??null,loading:t,signIn:i,signOut:l,changePassword:o}}},2451:(e,s,t)=>{"use strict";t.d(s,{k:()=>n});var r=t(7577);async function a(){let e=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=eur");if(!e.ok)throw Error("Failed to fetch BTC price.");let s=await e.json(),t=s?.bitcoin?.eur;if(!t||"number"!=typeof t)throw Error("BTC price data unavailable.");return t}function n(e=6e4){let[s,t]=(0,r.useState)(0),[n,i]=(0,r.useState)(!0),[l,o]=(0,r.useState)(null);return{price:s,loading:n,error:l,refresh:(0,r.useCallback)(async()=>{try{let e=await a();t(e),o(null)}catch(e){o(e instanceof Error?e.message:"Failed to load BTC price.")}finally{i(!1)}},[])}}},3566:(e,s,t)=>{"use strict";t.d(s,{HC:()=>n,JA:()=>a,n:()=>r});let r=.21,a=20,n=.99},5077:(e,s,t)=>{"use strict";t.d(s,{fr:()=>i,jl:()=>l,lb:()=>n});let r=new Intl.NumberFormat("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}),a=new Intl.NumberFormat("de-DE",{maximumFractionDigits:0});function n(e){return r.format(e)}function i(e){return a.format(e)}function l(e){return e.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:5})}},958:(e,s,t)=>{"use strict";t.d(s,{AW:()=>n,Zt:()=>a});var r=t(4800);async function a(e){let{data:s,error:t}=await r.O.from("clients").select("client_id, display_name, email").eq("email",e).single();if(t)throw t;return s||null}async function n(e){let{data:s,error:t}=await r.O.from("investments").select("*").eq("client_id",e).order("date_swap",{ascending:!0});if(t)throw t;return s??[]}},4800:(e,s,t)=>{"use strict";t.d(s,{O:()=>i});var r=t(5157);let a=process.env.NEXT_PUBLIC_SUPABASE_URL,n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!a||!n)throw Error("Missing Supabase environment variables.");let i=(0,r.eI)(a,n)},8256:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`C:\Users\marti.castan\Documents\altres\D.Inversions\PgWeb\prod-dinv\src\app\dashboard\page.tsx#default`)},2029:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,metadata:()=>a});var r=t(9510);t(5023);let a={title:"D.Inversions - Bitcoin Portfolio",description:"Track your Bitcoin investments and performance."};function n({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{children:e})})}},5023:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[819,313],()=>t(2328));module.exports=r})();